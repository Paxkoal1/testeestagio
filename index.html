<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <script src="js/campo-minado.js"></script>
</head>

<body>
    <div id="exibir-execucao"></div>

    <script>
        var campoMinado = new CampoMinado();


        document.getElementById('exibir-execucao').innerHTML += '----------- Início do jogo -----------';
        document.getElementById('exibir-execucao').innerHTML += '<pre>' + campoMinado.Tabuleiro() + '</pre>';


        campoMinado.Tabuleiro().replaceAll("\\r\\n", "");

        function verificarBombas(i, j) {
            var bombas = [];
            var casasMarcadas = [];
            var contador = 0;



            if (campoMinado.Tabuleiro()[i][j] != "-") {

                //esquerda acima
                if (campoMinado.Tabuleiro()[i - 1, j - 1] == "-" || campoMinado.Tabuleiro()[i - 1, j - 1] === undefined) {
                    contador++;
                    casasMarcadas.push({
                        i: i - 1,
                        j: j - 1
                    })
                    casasMarcadas.push([i-1,j-1]);


                    if (bombas.length != 0) {


                    }
                }

                //acima
                if (campoMinado.Tabuleiro()[i - 1, j] == "-" || campoMinado.Tabuleiro()[i - 1, j] === undefined) {
                    contador++;
                    casasMarcadas.push({
                        i: i - 1,
                        j: j
                    })
                }
                //direita acima
                if (campoMinado.Tabuleiro()[i - 1, j + 1] == "-" || campoMinado.Tabuleiro()[i - 1, j + 1] === undefined) {
                    contador++;
                    casasMarcadas.push({
                        i: i - 1,
                        j: j + 1
                    })
                }
                //esquerda
                if (campoMinado.Tabuleiro()[i, j - 1] = "-" || campoMinado.Tabuleiro()[i, j - 1] === undefined) {
                    contador++;
                    casasMarcadas.push({
                        i: i,
                        j: j - 1
                    })
                }
                //direita
                if (campoMinado.Tabuleiro()[i, j + 1] == "-" || campoMinado.Tabuleiro()[i, j + 1] === undefined) {
                    contador++;
                    casasMarcadas.push({
                        i: i,
                        j: j + 1
                    })
                }
                //esquerda abaixo
                if (campoMinado.Tabuleiro()[i + 1, j - 1] == "-" || campoMinado.Tabuleiro()[i + 1, j - 1] === undefined) {
                    contador++;
                    casasMarcadas.push({
                        i: i + 1,
                        j: j - 1
                    })
                }
                //abaixo
                if (campoMinado.Tabuleiro()[i + 1, j] == "-" || campoMinado.Tabuleiro()[i + 1, j] === undefined) {
                    contador++;
                    casasMarcadas.push({
                        i: i + 1,
                        j: j
                    })
                }
                //direita abaixo
                if (campoMinado.Tabuleiro()[i + 1, j + 1] == "-" || campoMinado.Tabuleiro()[i + 1, j + 1] === undefined) {
                    contador++;
                    casasMarcadas.push({
                        x: i + 1,
                        y: j + 1
                    })
                }

            }

            if (contador == campoMinado.Tabuleiro()[i][j]) {

                casasMarcadas.map(c => {
                    bombas.push(c);
                })
            }
            if (campoMinado.Tabuleiro() != bombas) {

                campoMinado.Abrir(i, j);
                console.log(casasMarcadas);
                //bombas.forEach(document.getElementById('exibir-execucao').innerHTML += 'Bomba encontrada na casa (' + (i + 1) + ',' + (j + 1) + ')');
            }

        };

        for (var i = 0; i < 9; i++) {

            for (var j = 0; j < 9; j++) {


                if (campoMinado.JogoStatus() == 0) {


                    verificarBombas(i, j);

                    //document.getElementById('exibir-execucao').innerHTML += 'Abrindo Casa (' + (i + 1) + ',' + (j + 1) + ')';
                    document.getElementById('exibir-execucao').innerHTML += '<pre>' + campoMinado.Tabuleiro() + '</pre>';

                }

                else if (campoMinado.JogoStatus() == 2) {

                    document.getElementById('exibir-execucao').innerHTML += '----------- Status: Derrota -----------';
                    document.getElementById('exibir-execucao').innerHTML += '<pre>' + campoMinado.Tabuleiro() + '</pre>';

                    break;
                }
                else {
                    document.getElementById('exibir-execucao').innerHTML += '----------- Status: Vitória -----------';
                    document.getElementById('exibir-execucao').innerHTML += '<pre>' + campoMinado.Tabuleiro() + '</pre>';

                    break;

                }

            }
        }

    </script>
</body>

</html>